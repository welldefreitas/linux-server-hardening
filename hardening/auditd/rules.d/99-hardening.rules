# auditd baseline rules (CIS-inspired)
# Minimal but high-signal rules for auth & critical config tampering.

-D
-b 8192

# Identity files
-w /etc/passwd -p wa -k identity
-w /etc/group -p wa -k identity
-w /etc/shadow -p wa -k identity
-w /etc/gshadow -p wa -k identity

# Sudoers
-w /etc/sudoers -p wa -k sudoers
-w /etc/sudoers.d/ -p wa -k sudoers

# SSH configuration
-w /etc/ssh/sshd_config -p wa -k sshd
-w /etc/ssh/sshd_config.d/ -p wa -k sshd

# Time changes
-a always,exit -F arch=b64 -S adjtimex -S settimeofday -k time-change
-a always,exit -F arch=b64 -S clock_settime -k time-change
-w /etc/localtime -p wa -k time-change

# Auth logs (path may vary by distro)
-w /var/log/auth.log -p wa -k authlog

# Make rules immutable until reboot (optional; uncomment for stricter posture)
# -e 2
