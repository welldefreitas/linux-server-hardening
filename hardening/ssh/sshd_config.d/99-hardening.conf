# Enterprise SSH hardening baseline (drop-in).
# Safe-by-default. Values injected at apply-time.
# NOTE: Test in staging first to avoid lockouts.

Port __SSH_PORT__
Protocol 2

PermitRootLogin no
PermitEmptyPasswords no
PubkeyAuthentication yes

# If ALLOW_PASSWORD_AUTH=false, script sets PasswordAuthentication no.
# WARNING: Ensure key-based auth is working before disabling passwords.
PasswordAuthentication __PASSWORD_AUTH__

# Reduce brute-force surface
MaxAuthTries 3
LoginGraceTime 30
ClientAliveInterval 300
ClientAliveCountMax 2

# Logging
LogLevel VERBOSE

# Disable risky features (tune per profile)
X11Forwarding no

# Bastion profile may require forwarding for ProxyJump/port forwarding.
AllowTcpForwarding __ALLOW_TCP_FORWARDING__
AllowAgentForwarding __ALLOW_AGENT_FORWARDING__

PermitTunnel no
GatewayPorts no

# Stronger defaults
UseDNS no

# Ubuntu 24.04 / modern OpenSSH: reduce interactive auth attack surface
KbdInteractiveAuthentication no
